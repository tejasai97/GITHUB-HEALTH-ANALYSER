# UseCases


## Use Case: Access statistics regarding popular libraries


### 1 Preconditions
The user must set up all the required software tools which are required to access the portal.

### 2 Main Flow
The user will select the organization from the list displayed in the portal [S1]. Portal will provide a packed bubble chart representing the top libraries in the organization [S2]. On selecting the library, the portal provides more information regarding this library usage [S3].

### 3 Subflows
[S1] Data related to the organization will be retrieved from the database.

[S2] The portal queries data regarding the libraries and converts this data into a visual format which can be further drilled down.

[S3] The portal displays all the repositories have used the selected library. 


## Use Case: Access information about health and activity of repository


### 1 Preconditions
The user must select the organization to which the desired repository belongs to.

### 2 Main Flow
The user will select the desired repository to obtain insights [S1]. The portal displays details regarding the health and activity of a repository [S2]. The portal also provides additional information regarding the activity of a repository [S3].

### 3 Subflows
[S1] Data related to the repository will be retrieved from the database based on the user’s selection.

[S2] The portal retrieves data related to the health of the selected repository and provides a score.

[S3] Portal generates line charts regarding the trends in forks of the selected repository.


## Use Case: Access information about the response time of repository


### 1 Preconditions
The user must select the organization to which the desired repository belongs to.

### 2 Main Flow
The user will select the desired repository to obtain insights [S1]. The portal provides details related to the response time of the selected repository [S2].

### 3 Subflows
[S1] Data related to the repository will be retrieved from the database based on the user’s selection.

[S2] Portal converts repository specific data such as time taken to resolve various issues over a period of time into a line chart and displays the total average response time.


# Mocking 


These are the following steps which are done to inject mock data into the database


## REST API
We used Github REST API's to obtain data of the repository and store them in JSON format using python. The API's used can be found here [REST API](https://developer.github.com/v3/).

This data is stored in MongoDB, The schema of the database is described below.


## MongoDB

MongoDB is a cross-platform document-oriented database program. Classified as a NoSQL database program, MongoDB uses JSON-like documents with schemata.


Collection: a Collection is a group of MongoDB documents. It is the equivalent of an RDBMS table. A collection exists within a single database. 

Document: A document is a set of key-value pairs. Documents have a dynamic schema. Dynamic schema means that documents in the same collection do not need to have the same set of fields or structure, and common fields in a collection's documents may hold different types of data.

In our schema, we have 3 collections 

1) **Company** collection: which has records of the organization and its related data

**_The Attributes are_** :

**id** : Primary key column of the collection generated by MongoDB

**OrgName** : The organization name

**RepoList** : List of repositories for that particular organization

![image](https://media.github.ncsu.edu/user/13118/files/974b7680-4113-11e9-9eb1-b8536377c424)

2) **Libraries** collection: which contains records of various libraries used in a repository

**_The Attributes are_**

**id** : Primary key column of this collection by MongoDB

**LibName** : The library name

**OrgName** : The organization name to which this library belongs to 

**LibRepos** : The list of repositories in which this library has been used.

![image](https://media.github.ncsu.edu/user/13118/files/b813cc00-4113-11e9-8fce-811e25939eba)

3) **Repository** collection: which contains records of various metrics of a repository

**_The Attributes are_** 

**id** : Primary key column of this collection by MongoDB

**name** : Repository Name 

**openpullrequests** : Number of pull requests which are open 

**closepullrequest** : Number of pull requests which are closed

**openissues** : The number of issues which are yet to be resolved

**closeissues** : The number of issues which are closed i.e resolved

**health** : Health score of the repository out of 100

**forks** : Number of forks made in that repository

**commits** : Number of commits made to that repository

**forkdates** : List of dates on which forks are made, stored as DateTime 

**responsetime** : The number of days took to resolve an issue, for every closed issue

![image](https://media.github.ncsu.edu/user/10117/files/eb1d9480-41d3-11e9-8948-0b84d67ca809)

## Tableau

Tableau connects to the database using [MongoDB Connector for BI](https://docs.mongodb.com/bi-connector/master/), allows users to create queries with SQL and visualize, graph, and report on their MongoDB data using tools such as Tableau.

The SQL schema for the above can be found [here](https://github.ncsu.edu/sgadipa/csc510-project/blob/master/backend/database/schema.drdl)


_The final mock data that is exported in json format from MongoDB can be found [here](https://github.ncsu.edu/sgadipa/csc510-project/tree/master/backend/database/mockdata)_

# Implementation

The following diagram shows the data flow and all the components present in the application.

![image](https://media.github.ncsu.edu/user/10117/files/6c2b5a80-41d9-11e9-8859-088dd1d1f86f)

**GitHub REST APIs** : Initially, the data is retrieved from Github REST API's using python in json format.

**Intermediate Server** : This server consists of two components

**1. Health Calculator** : This component receives data from REST APIs in JSON format. we are using [requests](http://docs.python-requests.org/en/master/) library and Personal Access Token to retrieve this data.

**2. Database Driver** : This component retrieves data from Health Calculator and sends it to the database using **[pymongo](https://api.mongodb.com/python/current/)** library.

Later these two components will be integrated into a Flask Server which is a python micro framework.

**MongoDB** : The MongoDB is hosted on **AWS EC2** instance which is a web service that provides secure, resizable compute capacity in the cloud. The EC2 instance is running on Ubuntu 16 Operating System.

**BI Connector** : For Tableau to connect to the database we use **MongoDB Connector for BI**. We used **mongosqld** which is a BI Connector which connects the database instance to Tableau. It accepts incoming requests from SQL client(Tableau) and proxies those requests to the database instance. By default, it generates data schema which is mentioned in mocking section.

**DSN** : we need to create a system **DSN** for the mongosqld process. It is a saved configuration which describes a database connection to be used by an ODBC driver. The DSN configuration can be found [here](https://github.ncsu.edu/sgadipa/csc510-project/blob/master/backend/database/odbc.ini).

**Tableau** : Tableau connects to the database using the MongoDB BI Connector. The data is represented in a table format which is joined as follows: 

![image](https://media.github.ncsu.edu/user/12731/files/33e60b00-3f92-11e9-88dd-fea54fdb65ec)

The user can navigate through the Portal using actions. Tableau actions can add context and interactivity to data. Users interact with your visualization by selecting marks or clicking a menu and the actions we set up can respond with navigation and changes in the view.


# Task Tracking

We have created a worksheet which provides details regarding the work distribution among the teammates for each iteration. It also provides links to the tasks in Azure DevOps.

[WORKSHEET.md](https://github.ncsu.edu/sgadipa/csc510-project/blob/master/WORKSHEET.md)

# Screencast

We have created a screencast explaining the database schema, data ingestion and the user interaction with the portal. you can look at the video by clicking [here](https://www.youtube.com/watch?v=vbSnFqyeWJI&feature=youtu.be).

You can also download the video from [here](https://github.ncsu.edu/sgadipa/csc510-project/blob/master/videos/screencast.mp4).


